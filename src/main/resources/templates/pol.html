<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<link th:rel="stylesheet" type="text/css"
	th:href="@{/css/misestilos.css}">
<link th:rel="stylesheet" type="text/css"
	th:tref="@{/webjars/bootstrap/4.5.0/css/bootstrap.min.css}">
<link th:rel="stylesheet"
	th:tref="@{/webjars/font-awesome/5.11.2/css/all.css} " />
<script src="https://use.fontawesome.com/releases/v5.0.7/js/all.js"></script>
<script
	src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
<script
	src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"></script>
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.1/css/bootstrap.css">
<meta charset="UTF-8">
<title>Pol</title>
</head>
<body>
	<div th:insert="layout/header :: header"></div>
	<div class="container">
		<h2>Crea tu punto de interes</h2>
		<form id="formPol" th:object="${unPol}"
			th:action="${editMode}?@{/pol/modificar}:@{/pol/guardar}"
			method="post" enctype="multipart/form-data">
			<div class="form-row">
				<div class="form-group col-md-6">
					<label for="nombrepol">Nombre</label> <input type="text" 
						class="form-control" id="nombrepol" th:field="*{nombre}">
					<small class="form-text text-danger"
						th:if="${#fields.hasErrors('nombre')}" th:errors="*{nombre}">Error</small>
				</div>
				<div class="form-group col-md-6">
					<label for="descripcionpol">Descripcion</label> <input type="text"
						class="form-control" id="descripcionpol" th:field="*{descripcion}">
					<small class="form-text text-danger"
						th:if="${#fields.hasErrors('descripcion')}"
						th:errors="*{descripcion}">Error</small>
				</div>
			</div>
			<input type="hidden" th:field="*{codigo}" th:if="${editMode}">
			<details>
			<summary>Direcciones de referencia</summary>
			<div class="form-row">
				<div class="form-group col-md-3">
					<label for="nombrepol">Calle</label> <input type="text"
						class="form-control" id="nombrepol" th:field="*{calle}"> <small
						class="form-text text-danger"
						th:if="${#fields.hasErrors('calle')}" th:errors="*{calle}">Error</small>
				</div>
				<div class="form-group col-md-3">
					<label for="barriopol">Barrio</label> <input type="text"
						class="form-control" id="barriopol" th:field="*{barrio}">
					<small class="form-text text-danger"
						th:if="${#fields.hasErrors('barrio')}" th:errors="*{barrio}">Error</small>
				</div>
				<div class="form-group col-md-3">
					<label for="numeropol">Numero</label> <input type="number"
						class="form-control" id="numeropol" th:field="*{numeroCasa}">
					<small class="form-text text-danger"
						th:if="${#fields.hasErrors('numeroCasa')}"
						th:errors="*{numeroCasa}">Error</small>
				</div>
				<div class="form-group col-md-3">
					<label for="localidadpol">Localidad</label> <input type="text"
						class="form-control" id="localidadpol" th:field="*{localidad}">
					<small class="form-text text-danger"
						th:if="${#fields.hasErrors('localidad')}" th:errors="*{localidad}">Error</small>
				</div>
			</div>
			</details>
			<p>
			<div class="form-row">
				<div class="form-group col-md-6">
					<label for="sitiowebpol">Sitio Web</label> <input type="url"
						class="form-control" id="sitiowebpol" th:field="*{sitioWeb}">
				</div>
				<div class="form-group col-md-6">
					<label for="etiquetapol">Etiqueta</label> <select id="etiquetapol"
						class="form-control" th:field="*{etiqueta}">
						<option value="--Seleccione una etiqueta--" selected disabled>-- Seleccione una etiqueta --</option>
						<option value="Cultura">Cultura</option>
						<option value="Naturaleza">Naturaleza</option>
						<option value="Aventura">Aventura</option>
						<option value="Deportivo">Deportivo</option>
						<option value="Gastronomia">Gastronomia</option>
						<option value="Vacio">Ninguno</option>
					</select>
				</div>
			</div>
			<h5>Fotos(Rellenar una como minimo)</h5>
			<div class="form-row">
				<div class="form-group col md-12">
						<label for="file" class="col-sm-4 col-form-label" th:field="*{fotoEnlace}">
										</label>
										<div class="col-sm-10">
											<input type="file" name="file"  th:onclick="'javascript:a'"
											class="form-control-file" required
												id="file"
												accept="image/x-png,image/gif,image/jpeg,image/png,image/jpeg"
												onchange="loadFile(event)">
											<img id="output" style="padding-top: 2px; width: 146px;" />
										</div>
									
					</div>
				<div class="form-group col md-12">
						<label for="file" class="col-sm-4 col-form-label" th:field="*{fotoEnlace2}">
											</label>
										<div class="col-sm-10">
											<input type="file" name="file2" class="form-control-file"
												id="file2"
												accept="image/x-png,image/gif,image/jpeg,image/png,image/jpeg"
												onchange="loadFile(event)">
											<img id="output2" style="padding-top: 2px; width: 146px;" />
										</div>
									
					</div>
				<div class="form-group col md-12">
						<label for="file" class="col-sm-4 col-form-label" th:field="*{fotoEnlace3}">
											</label>
										<div class="col-sm-10">
											<input type="file" name="file3" class="form-control-file"
												id="file3"
												accept="image/x-png,image/gif,image/jpeg,image/png,image/jpeg"
												onchange="loadFile(event)">
											<img id="output3" style="padding-top: 2px; width: 146px;" />
										</div>
									
					</div>		
			</div>
			<div class="form-row">
				<div class="form-group col-md-6">
					<input type="submit" class="btn btn-success btn-block"
						th:value="${editMode}?'Modificar Pol':'Crear Pol'">
				</div>
				<div class="form-group col-md-6">
					<input type="reset" class="btn btn-secondary btn-block"
						value="Cancelar">
				</div>
			</div>
		</form>
		<!-- ---------------------------------------------------------------- -->
		<br>
		<h3>Lista de Mis Pois</h3>
		<br>
		<div class="table-responsive">
			<table class="table table-striped table-dark">
				<tr>
					<th>Nombre</th>
					<th>Descripcion</th>
					<th>Calle</th>
					<th>Barrio</th>
					<th>Numero</th>
					<th>Localidad</th>
					<th>Etiqueta</th>
					<th>Sitio Web</th>
					<th>Operaciones</th>
				</tr>
				<tr th:if="${pols.empty}">
					<td colspan="2">No hay productos en el listado</td>
				<tr th:each="po : ${pols}">
					<td th:text="${po.nombre}"></td>
					<td th:text="${po.descripcion}"></td>
					<td th:text="${po.calle}"></td>
					<td th:text="${po.barrio}"></td>
					<td th:text="${po.numeroCasa}"></td>
					<td th:text="${po.localidad}"></td>
					<td th:text="${po.etiqueta}"></td>
					<td th:text="${po.sitioWeb} ?: 'Vacio'"></td>
					<td><a href="#" th:href="@{'/pol/editar/'+${po.codigo}}">
							<i class="fa fa-edit"></i>
					</a> <a
						th:onclick="'javascript:confirmarEliminar(\''+${po.codigo}+'\');'">
							<i class="fa fa-trash-alt"></i>
					</a></td>
				</tr>
			</table>
		</div>
		<!--Modal Eliminar-->
		<div class="modal fade" id="modalEliminar" tabindex="-1" role="dialog"
			aria-labelledby="eliminarModal" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="eliminarModalTitulo">Confirmar
							eliminacion</h5>
						<button type="button" class="close" data-dismiss="modal"
							aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body">
						<h6>Â¿Estas seguro de eliminar el Pol?</h6>
					</div>
					<input type="hidden" id="identificadorPol" name="codigo" />
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary"
							data-dismiss="modal">Cancelar</button>
						<button type="button" class="btn btn-primary"
							th:onclick="eliminarPol()">Eliminar Pol</button>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="modalVender" tabindex="-1" role="dialog">
			<div class="modal-dialog modal-dialog-centered" >
				<div class="modal-content">
				
				</div>
			</div>
		</div>
		<div>
			<div class="row">
					<div th:each="c : ${pols}">
						<div class="col-sm-6">
								<div class="card" style="width: 14.99999rem;margin-top: 10px">
									<div th:id="'Nombre'+${c.codigo}" class="carousel slide" data-interval="false">
										<div class="carousel-inner">
   										 	<div class="carousel-item active">
		  										<img th:src="*{'data:;base64,'+c.fotoEnlace}" class="card-img-top" alt="imagen de producto" style="width: 100;height:100;display: block;">	
										 	</div>
										 	<div class="carousel-item">
										 		<div th:if="${c.fotoEnlace2}">
										 			<img th:src="*{'data:;base64,'+c.fotoEnlace2}" class="card-img-top" alt="imagen de producto" style="width: 100;">
										 		</div>
										 		<div th:unless="${c.fotoEnlace2}">
										 			<img src="..." alt="img">
										 			<h5>No hay una imagen aqui</h5>
    													<p>Siga avanzando</p>
										 		</div>
										 	</div>
										</div>
										<a class="carousel-control-prev" th:href="${'#Nombre'+c.codigo}" role="button" data-slide="prev">
									    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
									    <span class="sr-only">Previous</span>
									  </a>
									  <a class="carousel-control-next" th:href="${'#Nombre'+c.codigo}" role="button" data-slide="next">
									    <span class="carousel-control-next-icon" aria-hidden="true"></span>
									    <span class="sr-only">Next</span>
									  </a>	 			  						
			  						</div>					
			  						<div class="card-body">
									<p class="card-text" th:text="${'Nombre: '+c.nombre}">Nombre</p>
									<p class="card-text" th:text="${'Nombre: '+c.codigo}">Nombre</p>
									</div>
		  						</div>
						</div>
					</div>
			</div>
		</div>
	</div>
	<script th:src="@{/webjars/jquery/3.5.1/jquery.min.js}"
		type="text/javascript" src="webjars/jquery/3.5.1/jquery.min.js"></script>
	<script th:src="@{/webjars/popper.js/1.16.0/popper.min.js}"
		type="text/javascript" src="webjars/popper.js/1.16.0/popper.min.js"></script>
	<script th:src="@{/webjars/bootstrap/4.5.0/js/bootstrap.min.js}"
		type="text/javascript"
		src="webjars/bootstrap/4.5.0/js/bootstrap.min.js"></script>
	<script type="text/javascript">
		function confirmarEliminar(id) {
			$('#modalEliminar').modal('show');
			$("#identificadorPol").val(id);
		}

		function eliminarPol() {
			var id = $("#identificadorPol").val();
			window.location = "eliminarPol/" + id;
		}
	</script>
	<script type="text/javascript">
			$(document).ready(function() { $(".link-vender").on("click", function(event) {
									event.preventDefault();
									$("#modalVender").modal("show").find(".modal-content").load($(this).attr("href"));
								});
					});
		</script>
	<script type="text/javascript">
	$(function a() {

		  var // Define maximum number of files.
		      max_file_number = 3,
		      // Define your form id or class or just tag.
		      $form = $('file'), 
		      // Define your upload field class or id or tag.
		      $file_upload = $('#image_upload', $form), 
		      // Define your submit class or id or tag.
		      $button = $('.submit', $form); 

		  // Disable submit button on page ready.
		  $button.prop('disabled', 'disabled');

		  $file_upload.on('change', function () {
		    var number_of_images = $(this)[0].files.length;
		    if (number_of_images > max_file_number) {
		      alert(`You can upload maximum ${max_file_number} files.`);
		      $(this).val('');
		      $button.prop('disabled', 'disabled');
		    } else {
		      $button.prop('disabled', false);
		    }
		  });
		});
      </script>		
</body>
</html>